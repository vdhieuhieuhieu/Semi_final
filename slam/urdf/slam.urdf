<?xml version="1.0" encoding="utf-8"?>
<!-- This URDF was automatically created by SolidWorks to URDF Exporter! Originally created by Stephen Brawner (brawner@gmail.com) 
     Commit Version: 1.6.0-4-g7f85cfe  Build Version: 1.6.7995.38578
     For more information, please see http://wiki.ros.org/sw_urdf_exporter -->
<robot
  name="slam">
  <link
    name="base_link">
    <inertial>
      <origin
        xyz="7.08905460690135E-05 0.000481084981872881 0.0778548823491357"
        rpy="0 0 0" />
      <mass
        value="2.09949162696511" />
      <inertia
        ixx="0.00734332286725571"
        ixy="1.03087541218458E-05"
        ixz="0.000275530575243915"
        iyy="0.0121281379107237"
        iyz="0.000288164935908131"
        izz="0.017961388323586" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/base_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/base_link.STL" />
      </geometry>
    </collision>
  </link>
  <link
    name="wheel_left1_link">
    <inertial>
      <origin
        xyz="-5.55111512312578E-17 4.16333634234434E-17 0.0178230616302186"
        rpy="0 0 0" />
      <mass
        value="0.0414808039998363" />
      <inertia
        ixx="1.26297041000083E-05"
        ixy="-2.30093800126185E-38"
        ixz="-3.52660070687731E-39"
        iyy="1.26297041000083E-05"
        iyz="-5.77601258280972E-22"
        izz="1.23455181234334E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_left1_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_left1_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_left1_joint"
    type="continuous">
    <origin
      xyz="0.030040943208751 0.107 0.020999720595931"
      rpy="1.5707963267949 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_left1_link" />
    <axis
      xyz="0 0 -1" />
  </joint>
  <link
    name="wheel_left2_link">
    <inertial>
      <origin
        xyz="-2.77555756156289E-17 4.16333634234434E-16 0.0178230616302186"
        rpy="0 0 0" />
      <mass
        value="0.0414808039998362" />
      <inertia
        ixx="1.26297041000083E-05"
        ixy="-1.00317351992554E-22"
        ixz="-1.58990528709187E-21"
        iyy="1.26297041000083E-05"
        iyz="4.75821462374673E-22"
        izz="1.23455181234334E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_left2_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_left2_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_left2_joint"
    type="continuous">
    <origin
      xyz="-0.029959056791249 0.1065 0.0209997205959308"
      rpy="1.5707963267949 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_left2_link" />
    <axis
      xyz="0 0 -1" />
  </joint>
  <link
    name="wheel_right1_link">
    <inertial>
      <origin
        xyz="0 0 -0.0171769383697813"
        rpy="0 0 0" />
      <mass
        value="0.0414808039998362" />
      <inertia
        ixx="1.26297041000083E-05"
        ixy="-2.67045944210272E-22"
        ixz="-4.90527107634727E-22"
        iyy="1.26297041000083E-05"
        iyz="4.50151290698444E-22"
        izz="1.23455181234334E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_right1_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_right1_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_right1_joint"
    type="continuous">
    <origin
      xyz="0.030040943208751 -0.107 0.020999720595931"
      rpy="1.5707963267949 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_right1_link" />
    <axis
      xyz="0 0 -1" />
  </joint>
  <link
    name="wheel_right2_link">
    <inertial>
      <origin
        xyz="5.55111512312578E-17 -4.16333634234434E-17 -0.0171769383697813"
        rpy="0 0 0" />
      <mass
        value="0.0414808039998362" />
      <inertia
        ixx="1.26297041000083E-05"
        ixy="-1.01609821699666E-22"
        ixz="-4.9438728382664E-22"
        iyy="1.26297041000083E-05"
        iyz="4.50151290698444E-22"
        izz="1.23455181234333E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_right2_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/wheel_right2_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="wheel_right2_joint"
    type="continuous">
    <origin
      xyz="-0.029959056791249 -0.106 0.0209997205959308"
      rpy="1.5707963267949 0 0" />
    <parent
      link="base_link" />
    <child
      link="wheel_right2_link" />
    <axis
      xyz="0 0 -1" />
  </joint>
  <link
    name="camera_link">
    <inertial>
      <origin
        xyz="0.00697855527730018 -1.06579532170858E-05 0.0124683335079481"
        rpy="0 0 0" />
      <mass
        value="0.107910438139434" />
      <inertia
        ixx="7.12550253062256E-05"
        ixy="2.3393219677949E-08"
        ixz="-4.92986158651598E-08"
        iyy="7.71002569801307E-06"
        iyz="2.44769054883931E-10"
        izz="7.02567402877273E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/camera_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.898039215686275 0.917647058823529 0.929411764705882 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/camera_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="camera_joint"
    type="fixed">
    <origin
      xyz="0.0398464983353151 -0.00077408377455257 0.227605789912602"
      rpy="3.14159265358979 0 0" />
    <parent
      link="base_link" />
    <child
      link="camera_link" />
    <axis
      xyz="0 0 0" />
  </joint>
  <link
    name="lidar_link">
    <inertial>
      <origin
        xyz="-0.00712869032004071 2.01051559330367E-05 -0.03984851696699"
        rpy="0 0 0" />
      <mass
        value="0.0988519659696647" />
      <inertia
        ixx="2.01670226712523E-05"
        ixy="1.77520034791036E-08"
        ixz="-2.26332784491912E-06"
        iyy="5.01382792579843E-05"
        iyz="7.53617057520932E-09"
        izz="6.58296362275907E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/lidar_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.188235294117647 0.231372549019608 0.588235294117647 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://slam/meshes/lidar_link.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="lidar_joint"
    type="fixed">
    <origin
      xyz="-0.0976627823325977 0.000970509112063533 0.271318441191774"
      rpy="0 0 0" />
    <parent
      link="base_link" />
    <child
      link="lidar_link" />
    <axis
      xyz="0 0 0" />
  </joint>
  
  <gazebo>
  <plugin name="diff_drive_controller" filename="libgazebo_ros_diff_drive.so">
    <!-- Bật TF odom -> base_link -->
    <publishTf>true</publishTf>

    <!-- ROS namespace và remap topic -->
    <ros>
      <namespace>/</namespace>
      <remapping>cmd_vel:=/cmd_vel</remapping>
      <remapping>odom:=/odom</remapping>
    </ros>

    <!-- Khai báo joints đầy đủ (4 bánh xe) -->
    <leftJoint>wheel_left1_joint</leftJoint>
    <leftJoint>wheel_left2_joint</leftJoint>
    <rightJoint>wheel_right1_joint</rightJoint>
    <rightJoint>wheel_right2_joint</rightJoint>

    <!-- Thông số bánh xe -->
    <wheelSeparation>0.1785</wheelSeparation> <!-- Khoảng cách ngang giữa 2 bánh xe trái và phải -->
    <wheelDiameter>0.048</wheelDiameter>
    <wheelAcceleration>1.0</wheelAcceleration>
    <wheelTorque>10</wheelTorque>
    <velocityDecay>0.01</velocityDecay> <!-- giảm trượt bánh -->

    <!-- Chủ đề và khung TF -->
    <commandTopic>/cmd_vel</commandTopic>
    <odometryTopic>/odom</odometryTopic>
    <odometryFrame>odom</odometryFrame>
    <robotBaseFrame>base_link</robotBaseFrame>

    <!-- Xuất bản TF và Joint state -->
    <publishOdom>true</publishOdom>
    <publishOdomTF>true</publishOdomTF>
    <publishWheelTF>false</publishWheelTF>
    <publishWheelJointState>true</publishWheelJointState>

    <!-- Tần số cập nhật -->
    <updateRate>100</updateRate>

    <!-- Nguồn dữ liệu odometry -->
    <odometrySource>encoder</odometrySource>

    <!-- Chế độ tương thích -->
    <legacyMode>false</legacyMode>
  </plugin>
</gazebo>


<gazebo reference="lidar_link">
   <material>Gazebo/FlatBlack</material>
   
   <sensor type="ray" name="head_rplidar_sensor">
      <pose>0 0 0 0 0 0</pose>
      <visualize>true</visualize>
      <update_rate>10.0</update_rate> <!-- Giảm xuống 10 Hz -->
      
      <ray>
         <scan>
            <horizontal>
               <samples>720</samples> <!-- Tăng lên 360 mẫu -->
               <resolution>1</resolution>
               <min_angle>-3.1415</min_angle>
               <max_angle>3.1415</max_angle>
            </horizontal>
         </scan>
         
         <range>
            <min>0.120</min>
            <max>10</max>
            <resolution>0.015</resolution>
         </range>
      </ray>
      
      <plugin name="gazebo_ros_head_rplidar_controller" filename="libgazebo_ros_laser.so">
         <topicName>scan</topicName>
         <frameName>lidar_link</frameName>
         <gaussianNoise>0.01</gaussianNoise>
      </plugin>
   </sensor>
</gazebo>

</robot>
